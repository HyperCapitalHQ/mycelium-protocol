# Nodeç«¯æŠ€æœ¯é€‰å‹
1. æˆ‘ä»¬å†³å®šä»Flutterè¿ç§»åˆ°Tauriï¼ŒåŸå› æ˜¯flutteræ„Ÿè§‰è¿˜æ˜¯å¤æ‚å’Œåºå¤§ï¼Œè€ŒTauriåˆ™æ›´åŠ è½»é‡çº§ï¼ŒRustæ€§èƒ½ä¸é”™ã€‚
2. ç›®å‰æœªæµ‹è¯•Rustå¯¹äºåŒå¹³å°ç¡¬ä»¶(æ ¸å¿ƒæ˜¯æŒ‡çº¹æœºåˆ¶ç­‰passkey)æ”¯æŒçš„æ˜¯å¦okï¼Œä½†åŸç†ä¸Šåº”è¯¥æ²¡é—®é¢˜ï¼Œæœ€å·®è°ƒç”¨åˆ«äººã€‚
3. è€ŒåŸºäºNodeæˆ‘ä»¬è®¾è®¡äº†N0-N3ï¼Œä¸åŒçš„èŠ‚ç‚¹ç±»å‹ï¼š
   1. N0ï¼šWebç‰ˆ+Tauriæ‰“åŒ…ï¼Œå¯ä»¥æœ‰ä¸åŒå®ç°ï¼Œä½†å°½åŠ›ç»Ÿä¸€
   2. N1ï¼šå¢åŠ APIæœåŠ¡ï¼Œæä¾›ä¸€äº›åŸºç¡€æœåŠ¡ï¼Œä¾èµ–bkndæ¡†æ¶ï¼Œä¸»è¦è€ƒè™‘æ˜¯ç®€å•é€šç”¨çš„nodejsæŠ€æœ¯æ ˆ
   3. N2ï¼šTEEï¼Œä¾èµ–ç¡¬ä»¶ï¼ŒAPIä¾ç„¶å¯ä»¥ä¾èµ–bkndæˆ–è€…Rustç›´æ¥æä¾›ï¼ˆå¾…å®šï¼‰
   4. N3ï¼šP2Pæ¨¡å¼çš„ï¼Œæ›´å¤šæœåŠ¡ï¼Œæ›´é«˜å¹¶å‘
4. è€ŒæŠ€æœ¯æ ˆå¾ˆæ˜æ˜¾æ˜¯Webåº”ç”¨å…ˆå¼€å‘ï¼Œç„¶åè¿ç§»åˆ°Tauriï¼Œå‘å¸ƒåˆ°å¤šç«¯ã€‚
5. ä¿éšœæ‰€æœ‰åº”ç”¨æ˜¯åŒä¸€ä¸ªé€»è¾‘å’Œå®ç°ï¼Œä¸»è¦åŸºäºNodejs
6. ä¸€äº›åº•å±‚ç¡¬ä»¶æœåŠ¡ï¼ŒWebç‰ˆæœ¬å¯ä»¥å…ˆå®ç°ä¾‹å¦‚ä¾èµ–æµè§ˆå™¨çš„WebAuthnï¼Œç„¶åå†å®ç°Rustç‰ˆæœ¬åˆ°å®¢æˆ·ç«¯ã€‚



å¯¹äºåº”ç”¨äº¤äº’çš„æŠ€æœ¯é€‰å‹,æˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªç²¾å·§çš„åç«¯æ¡†æ¶:https://github.com/bknd-io/bknd,
è€Œæˆ‘ä»¬è®¡åˆ’ä½¿ç”¨Tauriä½œä¸ºè·¨ç«¯çš„å£³,å½“ç„¶æœ€åŸºç¡€çš„æ˜¯Webåº”ç”¨,ç„¶åè¿ç§»åˆ°Tauri,å‘å¸ƒåˆ°å¤šç«¯ã€‚æˆ‘çš„ç–‘é—®æ˜¯è¿™ä¸ªåç«¯æ¡†æ¶åŒ…æ‹¬äº†clientã€åç«¯ã€UIã€element,æ˜¯å¦å¯ä»¥å®ç°åœ¨Tauriå†…è¿è¡Œ,å¹¶å¯¹å¤–æä¾›APIæœåŠ¡,å¯¹å†…nodejså®ç°ä¸€äº›åŸºç¡€æœåŠ¡,è€Œå¦å¤–ä¸€äº›æœåŠ¡,ä¸€æ¥Rustæ¥è°ƒç”¨ç¡¬ä»¶å®ç°,è¯·è¯„ä¼°æ­¤é€‰å‹æ–¹æ¡ˆ
æˆ‘æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªæŠ€æœ¯é€‰å‹æ–¹æ¡ˆã€‚é¦–å…ˆè®©æˆ‘äº†è§£ä¸€ä¸‹è¿™ä¸ªåç«¯æ¡†æ¶çš„å…·ä½“æƒ…å†µã€‚è®©æˆ‘è¿›ä¸€æ­¥äº†è§£bkndåœ¨Tauriç¯å¢ƒä¸­çš„è¿è¡Œå¯èƒ½æ€§ï¼šåŸºäºå¯¹bkndæ¡†æ¶å’ŒTauriæ¶æ„çš„åˆ†æï¼Œæˆ‘æ¥è¯„ä¼°ä½ çš„è¿™ä¸ªæŠ€æœ¯é€‰å‹æ–¹æ¡ˆï¼š
https://docs.bknd.io/start

## æŠ€æœ¯å¯è¡Œæ€§åˆ†æ

### bkndæ¡†æ¶ç‰¹ç‚¹
bkndæ˜¯ä¸€ä¸ªè½»é‡çº§ã€åŸºç¡€è®¾æ–½æ— å…³ä¸”åŠŸèƒ½ä¸°å¯Œçš„åç«¯ï¼Œå¯ä»¥åœ¨ä»»ä½•JavaScriptç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶ä¸”å¯ä»¥ä½œä¸ºAPIæœåŠ¡äºä»»ä½•JSè¿è¡Œæ—¶æˆ–æ¡†æ¶ã€‚å®ƒç›´æ¥åœ¨å‰ç«¯åº”ç”¨å†…è¿è¡Œï¼Œæ— éœ€å•ç‹¬çš„åç«¯ï¼Œæ”¯æŒNext.jsã€Remixã€Astroç­‰æ¡†æ¶ï¼Œä¹Ÿå¯ä»¥åœ¨Cloudflare Workersã€AWS Lambdaã€Bunæˆ–Nodeä¸Šç‹¬ç«‹è¿è¡Œã€‚

### åœ¨Tauriä¸­çš„å®ç°æ–¹æ¡ˆ

**æ–¹æ¡ˆ1ï¼šSidecaræ¨¡å¼ï¼ˆæ¨èï¼‰**
Tauriæ”¯æŒå°†Node.jsåº”ç”¨æ‰“åŒ…ä¸ºè‡ªåŒ…å«çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½œä¸ºsidecarä½¿ç”¨ï¼Œæ— éœ€æœ€ç»ˆç”¨æˆ·å®‰è£…Node.jsã€‚è¿™ç§æ–¹å¼å¯ä»¥ï¼š
- å°†bkndä½œä¸ºç‹¬ç«‹çš„Node.jsæœåŠ¡æ‰“åŒ…
- é€šè¿‡Tauriçš„sidecaræœºåˆ¶åµŒå…¥åˆ°åº”ç”¨ä¸­
- å¯¹å¤–æä¾›APIæœåŠ¡ï¼Œå¯¹å†…ä¸Ruståç«¯é€šä¿¡

**æ–¹æ¡ˆ2ï¼šçº¯å‰ç«¯é›†æˆ**
ç”±äºbkndå¯ä»¥ç›´æ¥åœ¨å‰ç«¯åº”ç”¨å†…è¿è¡Œï¼Œä½ å¯ä»¥ï¼š
- åœ¨Webå±‚ç›´æ¥é›†æˆbknd
- åˆ©ç”¨Tauriçš„å‰ç«¯ç¯å¢ƒè¿è¡Œbkndçš„å®¢æˆ·ç«¯éƒ¨åˆ†
- é€šè¿‡Tauri Commandä¸Ruståç«¯é€šä¿¡

## æ¶æ„ä¼˜åŠ¿

1. **æ··åˆæ¶æ„çµæ´»æ€§**ï¼šJavaScriptå¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®ç®¡ç†ï¼ŒRustå¤„ç†ç¡¬ä»¶è°ƒç”¨å’Œæ€§èƒ½æ•æ„Ÿæ“ä½œ
2. **å¼€å‘æ•ˆç‡**ï¼šbkndæä¾›Dataã€Authã€Mediaå’ŒFlowså››ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œå‡å°‘åŸºç¡€åŠŸèƒ½å¼€å‘å·¥ä½œ
3. **è·¨å¹³å°ä¸€è‡´æ€§**ï¼šWebä¼˜å…ˆå¼€å‘ï¼Œå†è¿ç§»åˆ°Tauriå¤šç«¯å‘å¸ƒ
4. **èµ„æºä¼˜åŒ–**ï¼šé¿å…äº†ä¼ ç»ŸC/Sæ¶æ„çš„ç½‘ç»œå¼€é”€

## æ½œåœ¨æŒ‘æˆ˜ä¸å»ºè®®

### æŒ‘æˆ˜
1. **æ‰“åŒ…å¤æ‚åº¦**ï¼šéœ€è¦åŒæ—¶ç®¡ç†Node.js runtimeå’ŒRust binary
2. **è°ƒè¯•éš¾åº¦**ï¼šå¤šè¯­è¨€æ ˆè°ƒè¯•ç›¸å¯¹å¤æ‚
3. **æ€§èƒ½å¼€é”€**ï¼šåŒruntimeå¯èƒ½å¸¦æ¥å†…å­˜å’Œå¯åŠ¨æ—¶é—´å¼€é”€
4. **ä¾èµ–ç®¡ç†**ï¼šéœ€è¦ç¡®ä¿Node.jsæ¨¡å—ä¸Tauriç¯å¢ƒå…¼å®¹

### ä¼˜åŒ–å»ºè®®
1. **é‡‡ç”¨Sidecaræ¨¡å¼**ï¼šå°†bkndæœåŠ¡ç‹¬ç«‹æ‰“åŒ…ï¼Œé€šè¿‡HTTP APIä¸å‰ç«¯é€šä¿¡
2. **åˆç†åˆ†å·¥**ï¼š
   - bkndï¼šå¤„ç†æ•°æ®æŒä¹…åŒ–ã€è®¤è¯ã€APIè·¯ç”±
   - Rustï¼šç¡¬ä»¶æ¥å£ã€æ–‡ä»¶ç³»ç»Ÿã€ç³»ç»Ÿè°ƒç”¨ã€è®¡ç®—å¯†é›†å‹ä»»åŠ¡
   - Frontendï¼šUIäº¤äº’ã€çŠ¶æ€ç®¡ç†
3. **æ¸è¿›å¼è¿ç§»**ï¼šå…ˆåœ¨Webç¯å¢ƒéªŒè¯bkndé›†æˆï¼Œå†é€‚é…Tauri
4. **èµ„æºéš”ç¦»**ï¼šç¡®ä¿Node.jså’ŒRustæœåŠ¡çš„èµ„æºä½¿ç”¨ç›¸äº’ç‹¬ç«‹

## æ€»ä½“è¯„ä¼°

è¿™ä¸ªé€‰å‹æ–¹æ¡ˆåœ¨æŠ€æœ¯ä¸Šæ˜¯**å¯è¡Œçš„**ï¼Œç‰¹åˆ«é€‚åˆï¼š
- éœ€è¦å¿«é€Ÿå¼€å‘å’Œè¿­ä»£çš„é¡¹ç›®
- æœ‰ç°æœ‰Node.jsç”Ÿæ€ä¾èµ–çš„å›¢é˜Ÿ
- éœ€è¦å¤æ‚æ•°æ®ç®¡ç†å’ŒAPIæœåŠ¡çš„åº”ç”¨
- è¦æ±‚è·¨å¹³å°ä¸€è‡´æ€§çš„äº§å“

å»ºè®®å…ˆåœ¨Webç¯å¢ƒä¸­éªŒè¯bkndçš„å®Œæ•´åŠŸèƒ½ï¼Œç„¶åé€šè¿‡Sidecaræ¨¡å¼é›†æˆåˆ°Tauriä¸­ï¼Œè¿™æ ·æ—¢èƒ½å‘æŒ¥å„æŠ€æœ¯æ ˆçš„ä¼˜åŠ¿ï¼Œåˆèƒ½ä¿æŒæ¶æ„çš„æ¸…æ™°æ€§ã€‚

# Rust é›†æˆæœåŠ¡æ–¹æ¡ˆ
è®©æˆ‘æœç´¢æ›´å…·ä½“çš„Rustå…¨æ ˆåç«¯æ¡†æ¶ï¼Œç±»ä¼¼bkndçš„åŠŸèƒ½ï¼šè®©æˆ‘æœç´¢æ›´å…·ä½“çš„Rustå…¨æ ˆè§£å†³æ–¹æ¡ˆï¼šåŸºäºæœç´¢ç»“æœï¼Œæˆ‘ä¸ºä½ åˆ†æRustç”Ÿæ€ä¸­ç±»ä¼¼bkndçš„åç«¯æ¡†æ¶é€‰æ‹©ï¼š

## ç›´æ¥å¯¹æ ‡bkndçš„Rustæ¡†æ¶

é—æ†¾çš„æ˜¯ï¼Œ**Rustç”Ÿæ€ä¸­æš‚æ—¶æ²¡æœ‰å®Œå…¨å¯¹æ ‡bkndçš„all-in-oneæ¡†æ¶**ã€‚bkndçš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå®ƒæä¾›äº†å¼€ç®±å³ç”¨çš„Dataã€Authã€Mediaã€Flowså››å¤§æ ¸å¿ƒæ¨¡å—ï¼Œè¿™ç§"instant backend"çš„ç†å¿µåœ¨Rustç”Ÿæ€ä¸­è¿˜æ¯”è¾ƒå°‘è§ã€‚

ä¸è¿‡ï¼Œæˆ‘å¯ä»¥æ¨èå‡ ä¸ªæ¥è¿‘çš„è§£å†³æ–¹æ¡ˆï¼š

## æœ€ä½³ç»„åˆæ–¹æ¡ˆ

### 1. **Axum + ç”Ÿæ€ç»„åˆï¼ˆæ¨èï¼‰**
Axumç”±tokioå›¢é˜Ÿå¼€å‘ï¼Œä¸“æ³¨äºæ— å®APIï¼Œç®€åŒ–é”™è¯¯å¤„ç†å’Œè°ƒè¯•ï¼Œå»ºç«‹åœ¨Towerå’ŒHyperä¹‹ä¸Šï¼Œè®¾è®¡ä¸ºå¥å£®ã€é«˜æ€§èƒ½ã€å¯é ä¸”ç¬¦åˆäººä½“å·¥ç¨‹å­¦ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- **Data**: Axum + SQLx + SeaORM
- **Auth**: axum-auth/tower-auth
- **Media**: tower-http + axum-typed-multipart
- **API**: åŸç”ŸRESTæ”¯æŒï¼Œä¼˜ç§€çš„ç±»å‹å®‰å…¨

### 2. **Rocketæ¡†æ¶ï¼ˆæœ€æ¥è¿‘bkndä½“éªŒï¼‰**
Rocketè®©ç¼–å†™å¿«é€ŸWebåº”ç”¨å˜å¾—ç®€å•ï¼Œä¸ç‰ºç‰²çµæ´»æ€§æˆ–ç±»å‹å®‰å…¨ã€‚

**ä¼˜åŠ¿**ï¼š
- å¼€å‘ä½“éªŒæœ€æ¥è¿‘bkndçš„ç®€æ´æ€§
- å†…ç½®JSONæ”¯æŒã€è¡¨å•å¤„ç†
- å¼ºå¤§çš„è¯·æ±‚å®ˆå«ç³»ç»Ÿï¼ˆé€‚åˆè®¤è¯ï¼‰
- å†…ç½®é™æ€æ–‡ä»¶æœåŠ¡ï¼ˆé€‚åˆMediaï¼‰

### 3. **æ–°å…´æ¡†æ¶ï¼šPrest**
Prestæ˜¯ä¸€ä¸ªæ¸è¿›å¼RESTfulæ¡†æ¶ï¼Œä¸“é—¨ä¸ºæ„å»ºWebåº”ç”¨è€Œè®¾è®¡ï¼Œè™½ç„¶è¿˜å¤„äºæ—©æœŸé˜¶æ®µï¼Œä½†ç†å¿µæ¥è¿‘bkndã€‚

## å®é™…æ¶æ„å»ºè®®

è€ƒè™‘åˆ°ä½ çš„éœ€æ±‚ï¼Œæˆ‘å»ºè®®é‡‡ç”¨ä»¥ä¸‹æŠ€æœ¯æ ˆï¼š## æ€»ç»“ä¸å»ºè®®

è™½ç„¶Rustç”Ÿæ€ä¸­æ²¡æœ‰å®Œå…¨å¯¹æ ‡bkndçš„æ¡†æ¶ï¼Œä½†é€šè¿‡ç»„åˆç°æœ‰çš„ä¼˜ç§€crateï¼Œä½ å¯ä»¥æ„å»ºå‡ºæ›´é«˜æ€§èƒ½ã€æ›´å®‰å…¨çš„åç«¯æœåŠ¡ã€‚

**æ¨èæ–¹æ¡ˆ**ï¼š
1. **Axumæ¡†æ¶** - æœ€ä½³çš„å¼€å‘ä½“éªŒå’Œæ€§èƒ½å¹³è¡¡
2. **æ¨¡å—åŒ–è®¾è®¡** - å‚è€ƒä¸Šé¢çš„æ¶æ„å›¾ï¼Œåˆ†åˆ«å®ç°Dataã€Authã€Mediaã€Flows
3. **æ¸è¿›å¼å¼€å‘** - ä»æ ¸å¿ƒAPIå¼€å§‹ï¼Œé€æ­¥æ·»åŠ åŠŸèƒ½

**ä¼˜åŠ¿**ï¼š
- æ€§èƒ½æ¯”Node.jsé«˜å‡ºæ•°å€
- å†…å­˜å®‰å…¨ï¼Œæ— åƒåœ¾å›æ”¶åœé¡¿
- ä¼˜ç§€çš„å¹¶å‘å¤„ç†èƒ½åŠ›
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥ï¼Œè¿è¡Œæ—¶æ›´ç¨³å®š

**æƒè¡¡**ï¼š
- å¼€å‘é€Ÿåº¦å¯èƒ½æ¯”bkndæ…¢ä¸€äº›
- å­¦ä¹ æ›²çº¿è¾ƒé™¡å³­
- éœ€è¦è‡ªå·±ç»„è£…å„ä¸ªæ¨¡å—

è€ƒè™‘åˆ°ä½ çš„æŠ€æœ¯æ ˆè§„åˆ’ï¼ˆNode.jså‰ç«¯ + Ruståç«¯ + Tauriæ¡Œé¢ç«¯ï¼‰ï¼Œè¿™ä¸ªæ–¹æ¡ˆèƒ½è®©ä½ å……åˆ†å‘æŒ¥å„è¯­è¨€çš„ä¼˜åŠ¿ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæœ‰å‰æ™¯çš„é€‰æ‹©ã€‚

## å…·ä½“æŠ€æœ¯æ ˆ
# Ruståç«¯æ¶æ„æ–¹æ¡ˆ

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

### Webæ¡†æ¶é€‰æ‹©
- **ä¸»æ¡†æ¶**: Axum (æ¨è) æˆ– Rocket
- **HTTPæœåŠ¡**: Hyper/Tower (Axumå†…ç½®)
- **å¼‚æ­¥è¿è¡Œæ—¶**: Tokio

### å››å¤§æ ¸å¿ƒæ¨¡å—å®ç°

#### 1. Data æ•°æ®å±‚
```rust
// ORMé€‰æ‹©
- SeaORM: å®Œæ•´çš„ORMï¼Œç±»ä¼¼ActiveRecord
- SQLx: è½»é‡çº§ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥SQL
- Diesel: æˆç†Ÿç¨³å®šï¼Œç±»å‹å®‰å…¨

// æ•°æ®åº“æ”¯æŒ
- PostgreSQL (æ¨è)
- SQLite (è½»é‡çº§éƒ¨ç½²)
- MySQL/MariaDB
```

#### 2. Auth è®¤è¯æ¨¡å—
```rust
// JWTè®¤è¯
- jsonwebtoken: JWTå¤„ç†
- axum-auth: Axumè®¤è¯ä¸­é—´ä»¶
- tower-auth: Towerè®¤è¯å±‚

// ä¼šè¯ç®¡ç†
- axum-sessions: ä¼šè¯æ”¯æŒ
- redis: ä¼šè¯å­˜å‚¨
```

#### 3. Media åª’ä½“æ–‡ä»¶
```rust
// æ–‡ä»¶ä¸Šä¼ å¤„ç†
- axum-typed-multipart: ç±»å‹å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ 
- tower-http: é™æ€æ–‡ä»¶æœåŠ¡
- tokio-util: æµå¤„ç†

// å­˜å‚¨æ–¹æ¡ˆ
- æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- AWS S3 (rust-s3)
- é˜¿é‡Œäº‘OSS
```

#### 4. Flows å·¥ä½œæµ(APIè®¾è®¡)
```rust
// APIè®¾è®¡
- åŸºäºAxumçš„è·¯ç”±ç³»ç»Ÿ
- towerä¸­é—´ä»¶é“¾
- è¯·æ±‚/å“åº”ç®¡é“

// åå°ä»»åŠ¡
- tokio-cron-scheduler: å®šæ—¶ä»»åŠ¡
- background-jobs: åå°ä½œä¸š
```

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main.rs              # åº”ç”¨å…¥å£
â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ mod.rs
â”‚   â””â”€â”€ database.rs
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ user.rs
â”‚   â””â”€â”€ media.rs
â”œâ”€â”€ handlers/            # è¯·æ±‚å¤„ç†å™¨
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ auth.rs
â”‚   â”œâ”€â”€ users.rs
â”‚   â””â”€â”€ media.rs
â”œâ”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ auth.rs
â”‚   â””â”€â”€ cors.rs
â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ auth_service.rs
â”‚   â””â”€â”€ media_service.rs
â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
    â”œâ”€â”€ mod.rs
    â””â”€â”€ error.rs
```

## ä¾èµ–é…ç½® (Cargo.toml)

```toml
[dependencies]
# Webæ¡†æ¶
axum = "0.7"
tower = "0.4"
tower-http = { version = "0.5", features = ["cors", "fs"] }
tokio = { version = "1.0", features = ["full"] }
hyper = "1.0"

# æ•°æ®åº“
sqlx = { version = "0.7", features = ["runtime-tokio-rustls", "postgres", "uuid", "chrono"] }
# æˆ–è€…ä½¿ç”¨ SeaORM
# sea-orm = { version = "0.12", features = ["sqlx-postgres", "runtime-tokio-rustls"] }

# åºåˆ—åŒ–
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# è®¤è¯
jsonwebtoken = "9.0"
bcrypt = "0.15"

# æ–‡ä»¶å¤„ç†
axum-typed-multipart = "0.11"
uuid = { version = "1.0", features = ["v4", "serde"] }

# é…ç½®ç®¡ç†
config = "0.14"
dotenvy = "0.15"

# é”™è¯¯å¤„ç†
anyhow = "1.0"
thiserror = "1.0"

# æ—¥å¿—
tracing = "0.1"
tracing-subscriber = "0.3"

# å¼€å‘å·¥å…·
tokio-dev = "0.1"
```

## å¿«é€Ÿå¯åŠ¨æ¨¡æ¿

```rust
// main.rs æ ¸å¿ƒç»“æ„
use axum::{
    routing::{get, post},
    Router,
    extract::State,
    http::StatusCode,
    response::Json,
};
use std::sync::Arc;

#[derive(Clone)]
struct AppState {
    db: sqlx::PgPool,
    // å…¶ä»–å…±äº«çŠ¶æ€
}

async fn create_app() -> Router {
    let db = setup_database().await;
    let state = Arc::new(AppState { db });

    Router::new()
        // APIè·¯ç”±
        .route("/api/health", get(health_check))
        .route("/api/auth/register", post(register))
        .route("/api/auth/login", post(login))
        .route("/api/users", get(get_users))
        .route("/api/media/upload", post(upload_file))
        // ä¸­é—´ä»¶
        .layer(
            tower_http::cors::CorsLayer::new()
                .allow_origin(tower_http::cors::Any)
                .allow_methods(tower_http::cors::Any)
                .allow_headers(tower_http::cors::Any)
        )
        .with_state(state)
}

#[tokio::main]
async fn main() {
    tracing_subscriber::init();
    
    let app = create_app().await;
    let listener = tokio::net::TcpListener::bind("0.0.0.0:3000").await.unwrap();
    
    println!("ğŸš€ Server running on http://localhost:3000");
    axum::serve(listener, app).await.unwrap();
}
```

## ä¸bkndçš„å¯¹æ¯”

| ç‰¹æ€§ | bknd (Node.js) | Rustæ–¹æ¡ˆ |
|------|---------------|----------|
| å¼€å‘é€Ÿåº¦ | â­â­â­â­â­ | â­â­â­ |
| æ€§èƒ½ | â­â­â­ | â­â­â­â­â­ |
| å†…å­˜å®‰å…¨ | â­â­ | â­â­â­â­â­ |
| ç”Ÿæ€æˆç†Ÿåº¦ | â­â­â­â­â­ | â­â­â­â­ |
| ç±»å‹å®‰å…¨ | â­â­â­ | â­â­â­â­â­ |
| å­¦ä¹ æ›²çº¿ | â­â­â­â­ | â­â­ |

## éƒ¨ç½²å»ºè®®

### DockeråŒ–éƒ¨ç½²
```dockerfile
FROM rust:1.75-slim as builder
WORKDIR /app
COPY . .
RUN cargo build --release

FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y ca-certificates
COPY --from=builder /app/target/release/your-app /usr/local/bin/
EXPOSE 3000
CMD ["your-app"]
```

### ä¸Taurié›†æˆ
- ç¼–è¯‘ä¸ºå•ç‹¬çš„äºŒè¿›åˆ¶æ–‡ä»¶
- é€šè¿‡HTTP APIä¸Node.jså‰ç«¯é€šä¿¡
- åˆ©ç”¨Tauriçš„IPCæœºåˆ¶è°ƒç”¨ç¡¬ä»¶åŠŸèƒ½

## å¼€å‘æµç¨‹å»ºè®®

1. **é˜¶æ®µä¸€**: ä½¿ç”¨Axum + SQLxå¿«é€Ÿæ­å»ºæ ¸å¿ƒAPI
2. **é˜¶æ®µäºŒ**: é›†æˆè®¤è¯å’Œæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
3. **é˜¶æ®µä¸‰**: æ·»åŠ ä¸­é—´ä»¶å’Œé”™è¯¯å¤„ç†
4. **é˜¶æ®µå››**: æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§
5. **é˜¶æ®µäº”**: ä¸Tauriå‰ç«¯é›†æˆæµ‹è¯•

## TS+Node.jsåç«¯+è¿ç§»åˆ°Ruståç«¯API
ä½ çš„ç–‘é—®å¾ˆå…³é”®ï¼Œè®©æˆ‘è¯¦ç»†åˆ†æä¸€ä¸‹ï¼šåŸºäºæœç´¢ç»“æœï¼Œæˆ‘æ¥è¯¦ç»†å›ç­”ä½ çš„ç–‘é—®ï¼š

## 1. Tauriå¯¹Node.jsçš„æ”¯æŒæƒ…å†µ

**Tauriæœ¬èº«æ²¡æœ‰å†…ç½®Node.jsè§£é‡Šå™¨**ï¼š
- Tauriä¸åµŒå…¥ä»»ä½•nodeè¿è¡Œæ—¶ï¼Œå”¯ä¸€çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨pkgç­‰å·¥å…·æ‰“åŒ…ä½ çš„nodeåº”ç”¨ï¼Œç„¶åå°†å…¶ç”¨ä½œsidecar
- éœ€è¦å°†Node.jsåº”ç”¨æ‰“åŒ…ä¸ºè‡ªåŒ…å«çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½œä¸ºsidecaråœ¨Tauriåº”ç”¨ä¸­ä½¿ç”¨ï¼Œè€Œä¸éœ€è¦æœ€ç»ˆç”¨æˆ·å®‰è£…Node.js

**Taurié‡å†™/æä¾›äº†ä»€ä¹ˆ**ï¼š
- Tauriä½¿ç”¨WRYæ¥æ¸²æŸ“åº”ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ºç³»ç»Ÿwebviewæä¾›ç»Ÿä¸€æ¥å£çš„åº“ï¼Œåœ¨macOSå’ŒiOSä¸Šä½¿ç”¨WKWebViewï¼Œåœ¨Windowsä¸Šä½¿ç”¨WebView2ï¼Œåœ¨Linuxä¸Šä½¿ç”¨WebKitGTKï¼Œåœ¨Androidä¸Šä½¿ç”¨Android System WebView
- Tauriç›´æ¥ä½¿ç”¨WRYå’ŒTAOæ¥å®Œæˆå‘OSçš„ç³»ç»Ÿè°ƒç”¨çš„é‡è¦å·¥ä½œï¼Œå®ƒä¸æ˜¯VMæˆ–è™šæ‹ŸåŒ–ç¯å¢ƒï¼Œè€Œæ˜¯ä¸€ä¸ªåº”ç”¨å·¥å…·åŒ…
- Tauri 2.0é‡å†™äº†IPCå±‚ï¼Œæ”¯æŒRaw Payloadsï¼Œæ”¹å˜äº†åº•å±‚å·¥ä½œæ–¹å¼ï¼Œä¹‹å‰æ‰€æœ‰IPCè½½è·éƒ½è¿›è¡Œjsonåºåˆ—åŒ–å’Œååºåˆ—åŒ–

## 2. åŸºäºä½ çš„éœ€æ±‚åˆ†æ

ä½ æƒ³"å……åˆ†åˆ©ç”¨webåº”ç”¨(nodejs)çš„ä»£ç ï¼Œä¸ç”¨é‡å†™ï¼Œå°‘åšé…ç½®å°±å¯ä»¥ç§»æ¤åˆ°Tauri"ï¼Œè¿™ä¸ªéœ€æ±‚åˆ†æï¼š

### Sidecaræ–¹æ¡ˆçš„é—®é¢˜ï¼š
1. **æ€§èƒ½å¼€é”€**ï¼šéœ€è¦æ‰“åŒ…æ•´ä¸ªNode.jsè¿è¡Œæ—¶
2. **ä½“ç§¯é—®é¢˜**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶ä¼šæ˜¾è‘—å¢å¤§
3. **å¤æ‚æ€§**ï¼šéœ€è¦ç®¡ç†è¿›ç¨‹é—´é€šä¿¡å’Œç”Ÿå‘½å‘¨æœŸ
4. **èµ„æºæ¶ˆè€—**ï¼šåŒæ—¶è¿è¡ŒRuståç«¯å’ŒNode.js sidecar

### æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼š**çº¯Ruståç«¯API + Node.jså‰ç«¯**## æ€»ç»“å»ºè®®

åŸºäºä½ çš„éœ€æ±‚åˆ†æï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š

1. **Tauriæœ¬èº«ä¸æä¾›Node.jsè§£é‡Šå™¨**ï¼Œåªæ˜¯æä¾›äº†ç³»ç»Ÿwebviewçš„å°è£…å’ŒRuståç«¯èƒ½åŠ›

2. **ä»ä»£ç å¤ç”¨è§’åº¦**ï¼Œçº¯Ruståç«¯API + Node.jså‰ç«¯æ–¹æ¡ˆæ›´ä¼˜ï¼š
   - å‰ç«¯ä»£ç å‡ ä¹ä¸éœ€è¦ä¿®æ”¹
   - åªéœ€è¦é‡å†™åç«¯APIéƒ¨åˆ†
   - æœ€ç»ˆè·å¾—æ›´å¥½çš„æ€§èƒ½å’Œæ›´å°çš„ä½“ç§¯

3. **å®æ–½è·¯å¾„å»ºè®®**ï¼š
   ```
   Step 1: åˆ†æç°æœ‰Node.js APIæ¥å£
   Step 2: ç”¨Rusté‡å†™è¿™äº›APIï¼ˆä¿æŒæ¥å£å…¼å®¹ï¼‰
   Step 3: å‰ç«¯è°ƒç”¨ä»HTTPæ”¹ä¸ºTauri Command
   Step 4: é€æ­¥ä¼˜åŒ–å’Œç±»å‹å®‰å…¨åŒ–
   ```

4. **å¦‚æœç¡®å®éœ€è¦å¿«é€Ÿè¿ç§»**ï¼ŒSidecaræ˜¯å¯è¡Œçš„ï¼Œä½†è¦æ¥å—ä½“ç§¯å’Œæ€§èƒ½çš„ä»£ä»·

ä½ çš„ç›´è§‰æ˜¯å¯¹çš„ - å¯»æ‰¾çº¯Rustç‰ˆæœ¬çš„åç«¯APIç¡®å®æ˜¯æ›´å¥½çš„é•¿æœŸæ–¹æ¡ˆï¼Œè™½ç„¶éœ€è¦ä¸€äº›é‡å†™å·¥ä½œï¼Œä½†èƒ½è·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡å’Œæ›´å°çš„åˆ†å‘ä½“ç§¯ã€‚

### å…·ä½“æ–¹æ¡ˆ
# Tauriæ¶æ„æ–¹æ¡ˆå¯¹æ¯”åˆ†æ

## æ–¹æ¡ˆAï¼šNode.js Sidecar + Tauri
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Tauri App            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     Web Frontend        â”‚â”‚  â† ä½ çš„ç°æœ‰Node.jsä»£ç 
â”‚  â”‚    (HTML/CSS/JS)        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Rust Core (Tauri)     â”‚â”‚  â† ç³»ç»Ÿè°ƒç”¨ã€ç¡¬ä»¶è®¿é—®
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Node.js Sidecar        â”‚â”‚  â† æ‰“åŒ…çš„Node.jsåç«¯
â”‚  â”‚  (pkg/nexeæ‰“åŒ…)         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜åŠ¿ï¼š
- âœ… å®Œå…¨é‡ç”¨ç°æœ‰Node.jsä»£ç 
- âœ… é›¶é‡å†™æˆæœ¬

### åŠ£åŠ¿ï¼š
- âŒ åº”ç”¨ä½“ç§¯å¤§ï¼ˆ+40-80MBï¼‰
- âŒ å†…å­˜å ç”¨é«˜ï¼ˆåŒè¿è¡Œæ—¶ï¼‰
- âŒ å¯åŠ¨æ—¶é—´é•¿
- âŒ è¿›ç¨‹ç®¡ç†å¤æ‚
- âŒ è°ƒè¯•å›°éš¾

## æ–¹æ¡ˆBï¼šçº¯Ruståç«¯API + è½»é‡å‰ç«¯ï¼ˆæ¨èï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Tauri App            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Web Frontend          â”‚â”‚  â† ä¿ç•™å‰ç«¯é€»è¾‘ï¼ŒAPIè°ƒç”¨
â”‚  â”‚  (React/Vue/Vanilla)    â”‚â”‚     æ”¹ä¸ºè°ƒç”¨Rust API
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Rust Backend API      â”‚â”‚  â† é‡å†™åç«¯APIï¼ˆä¸€æ¬¡æ€§å·¥ä½œï¼‰
â”‚  â”‚   + ç³»ç»Ÿè°ƒç”¨ + ç¡¬ä»¶     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜åŠ¿ï¼š
- âœ… åº”ç”¨ä½“ç§¯å°ï¼ˆ<10MBï¼‰
- âœ… æ€§èƒ½ä¼˜å¼‚ï¼ˆå•è¿è¡Œæ—¶ï¼‰
- âœ… å¯åŠ¨å¿«é€Ÿ
- âœ… å†…å­˜å ç”¨ä½
- âœ… è°ƒè¯•ç®€å•
- âœ… ç±»å‹å®‰å…¨

### å·¥ä½œé‡ï¼š
- ğŸ”„ éœ€è¦å°†Node.jsåç«¯APIè¿ç§»åˆ°Rust
- âœ… å‰ç«¯ä»£ç åŸºæœ¬æ— éœ€ä¿®æ”¹

## è¿ç§»ç­–ç•¥ï¼šæ¸è¿›å¼é‡å†™

### ç¬¬ä¸€é˜¶æ®µï¼šAPIå…¼å®¹å±‚
```rust
// åˆ›å»ºä¸åŸNode.js APIå®Œå…¨å…¼å®¹çš„Rustç«¯ç‚¹
// ä¾‹å¦‚ï¼šåŸæ¥çš„ POST /api/users
#[axum::debug_handler]
async fn create_user(
    Json(payload): Json<CreateUserRequest>
) -> Result<Json<UserResponse>, ApiError> {
    // å®ç°ä¸Node.jsç‰ˆæœ¬ç›¸åŒçš„é€»è¾‘
    // è¿”å›ç›¸åŒçš„JSONç»“æ„
}
```

### ç¬¬äºŒé˜¶æ®µï¼šå‰ç«¯APIè°ƒç”¨æ— ç¼åˆ‡æ¢
```javascript
// å‰ç«¯ä»£ç æ— éœ€ä¿®æ”¹
// ä»è°ƒç”¨ http://localhost:3000/api/users
// åˆ‡æ¢åˆ°è°ƒç”¨ Tauri API
import { invoke } from '@tauri-apps/api/core';

// åŸæ¥çš„fetchè°ƒç”¨
// const response = await fetch('/api/users', {...});

// ç°åœ¨é€šè¿‡Tauriå‘½ä»¤è°ƒç”¨
const response = await invoke('api_create_user', { payload });
```

### ç¬¬ä¸‰é˜¶æ®µï¼šé€æ­¥ä¼˜åŒ–
- åˆ©ç”¨Rustçš„æ€§èƒ½ä¼˜åŠ¿
- æ·»åŠ ç±»å‹å®‰å…¨
- ä¼˜åŒ–æ•°æ®ç»“æ„

## å…·ä½“å®æ–½å»ºè®®

### 1. APIæ˜ å°„è¡¨
åˆ›å»ºä¸€ä¸ªæ˜ å°„è¡¨ï¼Œå°†ç°æœ‰çš„Node.js APIä¸€ä¸€å¯¹åº”åˆ°Rustå®ç°ï¼š

```rust
// src/api/mod.rs
pub mod users;
pub mod auth;
pub mod media;

// ç»Ÿä¸€çš„APIè·¯ç”±å™¨
pub fn create_api_router() -> Router {
    Router::new()
        .route("/api/users", post(users::create_user))
        .route("/api/users", get(users::get_users))
        .route("/api/auth/login", post(auth::login))
        .route("/api/media/upload", post(media::upload))
        // ... å…¶ä»–API
}
```

### 2. æ•°æ®æ¨¡å‹å…¼å®¹
```rust
// ä¿æŒä¸Node.jsç‰ˆæœ¬ç›¸åŒçš„JSONç»“æ„
#[derive(Serialize, Deserialize)]
pub struct UserResponse {
    pub id: String,
    pub name: String,
    pub email: String,
    pub created_at: String, // ä¿æŒå­—ç¬¦ä¸²æ ¼å¼å…¼å®¹å‰ç«¯
}
```

### 3. é”™è¯¯å¤„ç†å…¼å®¹
```rust
// ä¿æŒä¸Node.jsç‰ˆæœ¬ç›¸åŒçš„é”™è¯¯å“åº”æ ¼å¼
#[derive(Serialize)]
pub struct ApiError {
    pub error: String,
    pub code: u16,
    pub message: String,
}
```

## æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | Node.js Sidecar | çº¯Rust API |
|------|----------------|------------|
| åº”ç”¨ä½“ç§¯ | ~60-100MB | ~8-15MB |
| å†…å­˜å ç”¨ | ~150-300MB | ~30-80MB |
| å¯åŠ¨æ—¶é—´ | 3-8ç§’ | <1ç§’ |
| APIå“åº”æ—¶é—´ | 10-50ms | 1-10ms |
| å¹¶å‘å¤„ç† | ä¸­ç­‰ | ä¼˜ç§€ |

## å¼€å‘å·¥ä½œé‡è¯„ä¼°

### Node.js Sidecaræ–¹æ¡ˆï¼š
- é…ç½®å·¥ä½œï¼š2-3å¤©
- æµ‹è¯•è°ƒè¯•ï¼š3-5å¤©
- **æ€»è®¡ï¼š1å‘¨**

### çº¯Rust APIæ–¹æ¡ˆï¼š
- APIé‡å†™ï¼š2-4å‘¨ï¼ˆå–å†³äºAPIå¤æ‚åº¦ï¼‰
- æµ‹è¯•è°ƒè¯•ï¼š1-2å‘¨
- **æ€»è®¡ï¼š3-6å‘¨**

## æœ€ç»ˆå»ºè®®

åŸºäºä½ çš„éœ€æ±‚"å……åˆ†åˆ©ç”¨webåº”ç”¨ä»£ç ï¼Œå°‘åšé…ç½®"ï¼Œæˆ‘å»ºè®®ï¼š

1. **çŸ­æœŸ**ï¼šå¦‚æœæ€¥éœ€ä¸Šçº¿ï¼Œå¯ä»¥å…ˆç”¨Sidecaræ–¹æ¡ˆå¿«é€Ÿè¿ç§»
2. **é•¿æœŸ**ï¼šé€æ­¥è¿ç§»åˆ°çº¯Rust APIæ–¹æ¡ˆï¼Œè·å¾—æ›´å¥½çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

**æœ€ä¼˜è·¯å¾„**ï¼š
```
ç°æœ‰Node.js Webåº”ç”¨ 
    â†“ 
Tauri + Node.js Sidecar (å¿«é€Ÿè¿ç§»)
    â†“
é€æ­¥å°†APIé‡å†™ä¸ºRust (æ€§èƒ½ä¼˜åŒ–)
    â†“
çº¯Ruståç«¯ + Webå‰ç«¯ (æœ€ç»ˆæ–¹æ¡ˆ)
```

è¿™æ ·æ—¢èƒ½å¿«é€Ÿå®ç°è·¨å¹³å°åˆ†å‘ï¼Œåˆèƒ½åœ¨åç»­è·å¾—æœ€ä½³çš„æ€§èƒ½å’Œä½“éªŒã€‚